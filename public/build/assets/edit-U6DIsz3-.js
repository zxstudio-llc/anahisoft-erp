import{j as e,H as N,L as E,a as w}from"./app-DQczwFTk.js";import{u as C,F,a as l,b as m,c,d,e as p,f as b}from"./form-9z_uuQ6M.js";import{A as _}from"./app-layout-CxNCz1W0.js";import{B as g}from"./button-BYXnJyXv.js";import{C as A,d as S}from"./card-BNPG6E-E.js";import{I as h}from"./input-goWATpHJ.js";import{T}from"./textarea-DHAakLHN.js";import{S as L}from"./switch-x9PZ-zT7.js";import{A as k,a as v,b as z}from"./avatar-CLHvFKAC.js";import{t as x}from"./index-Cou6Ygo0.js";import{Z as D,o as H,b as I,_ as P,s as j}from"./schemas-BDuxrwph.js";import"./app-C-su-A41.js";import"./index-D2mu7mBH.js";import"./utils-CPN-yreq.js";import"./label-BchK1h47.js";import"./index-CnB8Y-kE.js";import"./index-CTC3mW-r.js";import"./tenant-status-listener-Bzjk6yNz.js";import"./toast-lvG1LsW6.js";import"./app-sidebar-layout-DjIGW_b8.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-BVHM8iLO.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-CX1ZUDb2.js";import"./dropdown-menu-DWIT9g2E.js";import"./index-BfMh8EvQ.js";import"./index-CJpv9kZ5.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./dollar-sign-OeXEXPCy.js";import"./search-DPYN2drD.js";import"./app-logo-icon-2MFPo7KO.js";import"./cookie-consent-DYpW6VIi.js";import"./index-7Ou4doz_.js";const R=t=>async s=>{try{return{values:await t.parseAsync(s),errors:{}}}catch(a){if(a instanceof D){const n={};return a.errors.forEach(i=>{i.path&&(n[i.path.join(".")]={message:i.message})}),{values:{},errors:n}}throw a}},U=[{title:"Panel",href:"/admin"},{title:"Testimonios",href:"/admin/testimonials"},{title:"Editar",href:"/admin/testimonials/edit"}],Z=H({name:j().min(2,"El nombre debe tener al menos 2 caracteres").max(100),position:j().max(100).optional(),message:j().min(10,"El mensaje debe tener al menos 10 caracteres").max(500),photo:P(File).nullable().optional(),is_active:I().default(!0)});function ke({testimonial:t}){const s=C({resolver:R(Z),defaultValues:{name:t.name||"",position:t.position||"",message:t.message||"",photo:null,is_active:t.is_active??!0}}),{watch:a}=s,n=a("photo"),i=t.photo_url,y=async r=>{try{const o=new FormData;o.append("name",r.name),o.append("position",r.position||""),o.append("message",r.message),o.append("is_active",r.is_active?"1":"0"),o.append("_method","PUT"),r.photo&&o.append("photo",r.photo),await w.post(`/admin/testimonials/${t.id}`,o,{onSuccess:()=>{x.success("Testimonio actualizado correctamente",{description:"Los cambios se han guardado exitosamente"})},onError:u=>{x.error("Error al actualizar el testimonio",{description:"Hubo un problema al guardar los cambios"})}})}catch{x.error("Error inesperado",{description:"Hubo un problema al procesar el formulario"})}};return e.jsxs(_,{breadcrumbs:U,children:[e.jsx(N,{title:"Editar Testimonio"}),e.jsxs("div",{className:"hidden h-full flex-1 flex-col space-y-8 p-8 md:flex",children:[e.jsx("div",{className:"flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Editar testimonio"}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica los datos del testimonio"})]})}),e.jsx(A,{children:e.jsx(S,{className:"pt-6",children:e.jsx(F,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(y),className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"space-y-6 flex-1",children:[e.jsx(l,{control:s.control,name:"name",render:({field:r})=>e.jsxs(m,{children:[e.jsx(c,{children:"Nombre completo"}),e.jsx(d,{children:e.jsx(h,{placeholder:"Nombre del cliente",...r})}),e.jsx(p,{})]})}),e.jsx(l,{control:s.control,name:"position",render:({field:r})=>e.jsxs(m,{children:[e.jsx(c,{children:"Cargo o empresa"}),e.jsx(d,{children:e.jsx(h,{placeholder:"Ej: CEO de Empresa XYZ",...r})}),e.jsx(p,{})]})}),e.jsx(l,{control:s.control,name:"message",render:({field:r})=>e.jsxs(m,{children:[e.jsx(c,{children:"Testimonio"}),e.jsx(d,{children:e.jsx(T,{placeholder:"QuÃ© dice el cliente sobre tu servicio/producto",className:"min-h-[120px]",...r})}),e.jsx(p,{})]})})]}),e.jsxs("div",{className:"space-y-6 w-full md:w-1/3",children:[e.jsx(l,{control:s.control,name:"photo",render:({field:r})=>{var o;return e.jsxs(m,{children:[e.jsx(c,{children:"Foto del cliente"}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(k,{className:"w-32 h-32",children:n?e.jsx(v,{src:URL.createObjectURL(n)}):i?e.jsx(v,{src:i}):e.jsx(z,{children:((o=t.name)==null?void 0:o.charAt(0))||"T"})}),e.jsx(h,{type:"file",accept:"image/*",onChange:u=>{var f;r.onChange(((f=u.target.files)==null?void 0:f[0])||null)}})]})}),e.jsx(b,{children:"Deja en blanco para mantener la foto actual"}),e.jsx(p,{})]})}}),e.jsx(l,{control:s.control,name:"is_active",render:({field:r})=>e.jsxs(m,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Estado"}),e.jsx(b,{children:"Activar/desactivar este testimonio"})]}),e.jsx(d,{children:e.jsx(L,{checked:r.value,onCheckedChange:r.onChange})})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(g,{variant:"outline",type:"button",asChild:!0,children:e.jsx(E,{href:"/admin/testimonials",children:"Cancelar"})}),e.jsx(g,{type:"submit",disabled:s.formState.isSubmitting,children:s.formState.isSubmitting?"Actualizando...":"Actualizar Testimonio"})]})]})})})})]})]})}export{ke as default};
