import{j as e,r as w,u as Y,H as J}from"./app-DQczwFTk.js";import{t as j}from"./index-Cou6Ygo0.js";import{I as x}from"./input-error-MMK89I3I.js";import{P as K}from"./payment-modal-DplZBicJ.js";import{T as Q}from"./text-link-Ch0AlKgz.js";import{B as C}from"./button-BYXnJyXv.js";import{I as n}from"./input-goWATpHJ.js";import{L as l}from"./label-BchK1h47.js";import{A as X}from"./auth-split-layout-B2j_wqSS.js";import{A as Z}from"./api-DdUbHrO8.js";import{S as ee,a as ae,b as re,c as se,d as te}from"./select-D52pRjk-.js";import{L as ie}from"./loader-circle-0WVi89tk.js";import{C as h}from"./circle-check-X4JMQIil.js";import"./app-C-su-A41.js";import"./index-CTC3mW-r.js";import"./utils-CPN-yreq.js";import"./dialog-DHq7tLZ5.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-D2mu7mBH.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-BVHM8iLO.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./app-logo-icon-2MFPo7KO.js";import"./cookie-consent-DYpW6VIi.js";import"./card-BNPG6E-E.js";import"./index-BfMh8EvQ.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./chevron-down-Bqmppv4h.js";const le=({data:p,setData:f,errors:_,plans:v,formatPrice:t})=>{const g=v.find(s=>s.id===p.plan_id);return e.jsxs("div",{className:"grid gap-4",children:[e.jsxs(l,{htmlFor:"plan_id",children:["Seleccione un plan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ee,{value:p.plan_id||"",onValueChange:s=>f("plan_id",s),children:[e.jsx(ae,{id:"plan_id",className:"w-full",children:e.jsx(re,{placeholder:"Seleccione un plan",children:g&&e.jsxs("div",{className:"flex flex-col text-start",children:[e.jsx("span",{className:"font-medium text-sm",children:g.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g.is_free?"Gratis":t(g.price,p.billing_period)})]})})}),e.jsx(se,{children:v.map(s=>e.jsx(te,{value:s.id,children:e.jsxs("div",{className:"flex flex-col text-start",children:[e.jsx("span",{className:"font-medium text-sm",children:s.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.is_free?"Gratis":t(s.price,p.billing_period)})]})},s.id))})]}),e.jsx(x,{message:_.plan_id})]})};function Ge({plans:p,selectedPlanId:f,app_domain:_,billing_period:v="monthly"}){var I;const[t,g]=w.useState(1),{data:s,setData:c,post:U,processing:d,errors:m,setError:D,clearErrors:S}=Y({name:"",email:"",password:"",password_confirmation:"",company_name:"",ruc:"",domain:"",plan_id:(f==null?void 0:f.toString())??((I=p.find(a=>a.price===0))==null?void 0:I.id.toString())??"",billing_period:v??"monthly",status:"",condition:"",address:"",department:"",province:"",district:"",registration_date:"",trade_name:"",emission_system:"",accounting_system:"",foreign_trade_activity:"",economic_activities:[],payment_vouchers:[],electronic_systems:[],electronic_emission_date:"",electronic_vouchers:[],ple_date:"",registries:[],withdrawal_date:"",profession:"",ubigeo:"",capital:0,card_number:"",card_expiry:"",card_cvv:""}),[b,F]=w.useState(!1),[u,y]=w.useState(!1),[$,k]=w.useState(!1),o=p.find(a=>a.id===Number(s.plan_id)),P=(a,r)=>{if(r==="yearly"){const i=a*12,N=i*.15;return i-N}return a},R=a=>{if(!s.plan_id){j.error("Debe seleccionar un plan.");return}({...s},U(route("register"),{preserveScroll:!0,onSuccess:r=>{var N;const i=((N=r.props)==null?void 0:N.tenant_url)??(r==null?void 0:r.tenant_url);i?window.location.href=i:j.error("No se pudo redirigir al tenant")}}))},T=a=>{k(!1),R()},V=a=>{console.error("Error al procesar el pago:",a),j.error("Error al procesar el pago. Por favor intente nuevamente.")},E=async a=>{if(a.length===13){F(!0),y(!1),S("ruc");try{const r=await Z.validateRuc(a);if(!r.success)throw new Error(r.message||"No se pudo validar el RUC");c(i=>({...i,ruc:a,company_name:r.data.businessName,status:r.data.status,condition:r.data.condition,address:r.data.address,department:r.data.department,province:r.data.province,district:r.data.district,registration_date:r.data.registrationDate,trade_name:r.data.tradeName,accounting_system:r.data.accountingSystem,economic_activities:r.data.economicActivities})),y(!0)}catch(r){D("ruc",r instanceof Error?r.message:"Error validando RUC"),y(!1)}finally{F(!1)}}},q=a=>{const r=a.target.value.replace(/[^0-9]/g,"").slice(0,13);S("ruc"),c(i=>({...i,ruc:r,company_name:r.length===13?i.company_name:""})),y(!1),r.length===13&&E(r)},A=a=>{a.preventDefault();const r=a.clipboardData.getData("text").replace(/[^0-9]/g,"").slice(0,13);c(i=>({...i,ruc:r})),r.length===13&&E(r)},L=()=>{t<4&&(g(t+1),t<3&&window.scrollTo({top:0,behavior:"smooth"}))},z=()=>{t>1&&(g(t-1),window.scrollTo({top:0,behavior:"smooth"}))},M=async a=>{a.preventDefault();const r=()=>window.scrollTo({top:0,behavior:"smooth"});if(t===1){if(!s.ruc||!s.company_name||!s.domain){j.error("Por favor complete todos los campos obligatorios"),r();return}if(!u){j.error("Por favor valide el RUC antes de continuar"),r();return}}if(t===4){if(!s.name||!s.email||!s.password||!s.password_confirmation){j.error("Por favor complete todos los campos obligatorios"),r();return}if(o&&o.price>0){k(!0);return}R()}else L()},G=(a,r)=>`USD ${P(a,r).toLocaleString("es-US")}/${r==="monthly"?"mes":"año"}`,B=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"ruc",children:["RUC ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{id:"ruc",type:"text",required:!0,autoFocus:!0,tabIndex:1,value:s.ruc,onChange:q,onPaste:A,disabled:d||b,placeholder:"Número de RUC",maxLength:13,pattern:"[0-9]*",inputMode:"numeric",className:`bg-white/50 backdrop-blur-sm dark:bg-gray-900/50 ${u?"border-green-500 pr-20":"pr-10"} ${b?"border-yellow-500":""}`}),e.jsxs("div",{className:"absolute top-1/2 right-3 flex -translate-y-1/2 items-center gap-2",children:[b&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 animate-spin text-yellow-500"}),e.jsx("span",{className:"text-xs text-yellow-500",children:"Validando..."})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-xs text-green-500",children:"RUC Válido"})]})]})]}),e.jsx(x,{message:m.ruc}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ingrese el RUC de su empresa para validar los datos automáticamente."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"company_name",children:["Razón Social ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"company_name",type:"text",required:!0,tabIndex:2,value:s.company_name,onChange:a=>c("company_name",a.target.value),disabled:d||b||u,placeholder:"Razón social de la empresa",className:`bg-white/50 backdrop-blur-sm dark:bg-gray-900/50 ${u?"bg-green-50 dark:bg-green-950/10":""}`}),e.jsx(x,{message:m.company_name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"domain",children:["Subdominio ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{id:"domain",type:"text",required:!0,tabIndex:3,value:s.domain,onChange:a=>c("domain",a.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")),disabled:d||!u,placeholder:"miempresa",className:"flex-1 bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:_})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Este será el dominio donde accederá a su sistema de facturación."}),e.jsx(x,{message:m.domain})]})]}),H=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"trade_name",children:"Nombre Comercial"}),e.jsx(n,{id:"trade_name",type:"text",value:s.trade_name,onChange:a=>c("trade_name",a.target.value),disabled:d,placeholder:"Nombre comercial",className:"bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx(x,{message:m.trade_name})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"status",children:"Estado"}),e.jsx(n,{id:"status",type:"text",value:s.status,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"condition",children:"Condición"}),e.jsx(n,{id:"condition",type:"text",value:s.condition,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"address",children:"Dirección"}),e.jsx(n,{id:"address",type:"text",value:s.address,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"department",children:"Departamento"}),e.jsx(n,{id:"department",type:"text",value:s.department,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"province",children:"Provincia"}),e.jsx(n,{id:"province",type:"text",value:s.province,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"district",children:"Distrito"}),e.jsx(n,{id:"district",type:"text",value:s.district,disabled:!0,className:"bg-neutral-50 dark:bg-neutral-800"})]})]})]}),O=()=>e.jsxs(e.Fragment,{children:[e.jsx(le,{data:{plan_id:s.plan_id,billing_period:s.billing_period},setData:c,errors:m,plans:p.map(a=>({id:a.id.toString(),name:a.name,price:a.price,features:a.features})),formatPrice:(a,r)=>{const i=Number(a)||0;return r==="yearly"?`US ${(i*12*.85).toLocaleString("es-EC")} / año`:`US ${i.toLocaleString("es-EC")} / mes`}}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"name",children:["Nombre Completo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"name",type:"text",required:!0,autoComplete:"name",value:s.name,onChange:a=>c("name",a.target.value),disabled:d,placeholder:"Su nombre completo",className:"bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx(x,{message:m.name})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"email",children:["Correo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"email",type:"email",required:!0,autoComplete:"email",value:s.email,onChange:a=>c("email",a.target.value),disabled:d,placeholder:"correo@ejemplo.com",className:"bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx(x,{message:m.email})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"password",children:["Contraseña ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"password",type:"password",required:!0,autoComplete:"new-password",value:s.password,onChange:a=>c("password",a.target.value),disabled:d,placeholder:"Contraseña",className:"bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx(x,{message:m.password})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{htmlFor:"password_confirmation",children:["Confirmar Contraseña ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(n,{id:"password_confirmation",type:"password",required:!0,autoComplete:"new-password",value:s.password_confirmation,onChange:a=>c("password_confirmation",a.target.value),disabled:d,placeholder:"Confirmar contraseña",className:"bg-white/50 backdrop-blur-sm dark:bg-gray-900/50"}),e.jsx(x,{message:m.password_confirmation})]})]}),W=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Resumen de tu plan"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Revisa los detalles de tu plan antes de continuar"})]}),o&&o.price>0?e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-indigo-50 to-purple-50 p-4 dark:from-indigo-950/50 dark:to-purple-950/50",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsxs("div",{className:"flex w-full flex-col items-center gap-2 border-b border-indigo-100 pb-4 dark:border-indigo-800",children:[e.jsx("h4",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-xl font-semibold text-transparent",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.billing_period==="yearly"?"Facturación anual":"Facturación mensual"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"mb-1 text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total a pagar"}),e.jsx("p",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-3xl font-bold whitespace-nowrap text-transparent",children:G(o.price,s.billing_period)})]})]}),e.jsx("div",{className:"w-full",children:e.jsx("ul",{className:"grid grid-cols-1 gap-2",children:o.features.map((a,r)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:a})]},r))})})]})}):e.jsx("div",{className:"rounded-lg bg-gradient-to-br from-indigo-50 to-purple-50 p-4 dark:from-indigo-950/50 dark:to-purple-950/50",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsxs("div",{className:"flex w-full flex-col items-center gap-2 border-b border-indigo-100 pb-4 dark:border-indigo-800",children:[e.jsx("h4",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-xl font-semibold text-transparent",children:"Plan de Prueba Gratuito"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"30 días sin costo"}),e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"bg-gradient-to-r from-green-500 to-emerald-500 bg-clip-text text-3xl font-bold text-transparent",children:"Gratis"})})]}),e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Incluye:"}),e.jsxs("ul",{className:"grid grid-cols-1 gap-2 text-sm text-gray-600 dark:text-gray-300",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Hasta 100 facturas mensuales"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Validación de documentos"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Soporte por correo"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:"API básica"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-green-500"}),e.jsx("span",{className:"text-sm",children:"1 usuario"})]})]})]})]})})]});return e.jsxs(X,{title:"Crear una cuenta",description:"Ingrese su información para crear su cuenta y comenzar a facturar",children:[e.jsx(J,{title:"Register"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsx("div",{className:"absolute top-4 right-0 left-0 -z-10 h-[2px] bg-gray-200"}),e.jsx("div",{className:"absolute top-4 left-0 -z-10 h-[2px] bg-green-500 transition-all duration-500 ease-in-out",style:{width:`${(t-1)/3*100}%`}}),[{step:1,label:"Empresa"},{step:2,label:"Detalles"},{step:3,label:"Cuenta"},{step:4,label:"Pago"}].map(({step:a,label:r})=>e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:`mb-1 flex h-8 w-8 items-center justify-center rounded-full transition-all duration-300 ease-in-out ${t===a?"bg-indigo-600 text-white":t>a?"bg-green-500 text-white":"bg-gray-100 text-gray-400 dark:bg-gray-800"} ${t===a?"ring-2 ring-indigo-100 dark:ring-indigo-900/30":""} `,children:t>a?e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("span",{className:"text-sm font-medium",children:a})}),e.jsx("div",{className:`text-xs font-medium transition-colors duration-300 ${t===a?"text-indigo-600 dark:text-indigo-400":t>a?"text-green-500":"text-gray-400 dark:text-gray-500"}`,children:r})]},a))]})}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:M,children:[e.jsxs("div",{className:"grid max-h-[calc(100vh-24rem)] gap-4 overflow-y-auto",children:[t===1&&B(),t===2&&H(),t===3&&O(),t===4&&W()]}),e.jsxs("div",{className:"mt-auto flex justify-between gap-4",children:[t>1&&e.jsx(C,{type:"button",variant:"outline",onClick:z,disabled:d,className:"h-auto px-3 py-1.5 text-sm",children:"Anterior"}),t<4?e.jsx(C,{type:"button",onClick:L,disabled:d||b||t===1&&!u,className:"ml-auto h-auto w-full bg-gradient-to-r from-indigo-600 to-purple-600 px-3 py-1.5 text-sm text-white hover:from-indigo-700 hover:to-purple-700",children:"Siguiente"}):e.jsx(C,{type:"submit",disabled:d,className:"ml-auto h-auto w-full bg-gradient-to-r from-indigo-600 to-purple-600 px-3 py-1.5 text-sm text-white hover:from-indigo-700 hover:to-purple-700",children:d?"Creando...":o?"Pagar y Crear Cuenta":"Crear Cuenta"})]}),e.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["¿Ya tienes una cuenta? ",e.jsx(Q,{href:route("login"),children:"Iniciar sesión"})]})]}),e.jsx(K,{isOpen:$,onClose:()=>k(!1),amount:o?P(o.price,s.billing_period):0,planId:(o==null?void 0:o.id)||0,billingPeriod:s.billing_period,onPaymentSuccess:T,onPaymentError:V})]})}export{Ge as default};
