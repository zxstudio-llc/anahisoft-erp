import{j as e,r as i}from"./app-DQczwFTk.js";import{B as y}from"./button-BYXnJyXv.js";import{C as X}from"./checkbox-Cvj9wDgC.js";import{D as ce,b as oe,c as le,d as de,e as ne,f as me}from"./dialog-DHq7tLZ5.js";import{I as N}from"./input-goWATpHJ.js";import{L as p}from"./label-BchK1h47.js";import{c as W}from"./utils-CPN-yreq.js";import{C as pe}from"./index-ClSqUjUN.js";import{A as $}from"./api-DdUbHrO8.js";import{t as b}from"./index-Cou6Ygo0.js";import{C as xe,a as ue,d as he}from"./card-BNPG6E-E.js";import{A as Y,P as Z}from"./app-sidebar-layout-DjIGW_b8.js";import{P as J}from"./plus-BGuKkasZ.js";import{S as ge}from"./search-DPYN2drD.js";import{P as je}from"./pencil-Chy_hZuP.js";import{T as ve}from"./trash-2-b2Qe_qpo.js";import"./app-C-su-A41.js";import"./index-D2mu7mBH.js";import"./index-KJ4lOR0W.js";import"./index-BBPPPnEU.js";import"./index-7Ou4doz_.js";import"./index-BVHM8iLO.js";import"./index-CnB8Y-kE.js";import"./index-CTC3mW-r.js";import"./index-DcW1-0jE.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-BOxxC3ps.js";import"./index-CX1ZUDb2.js";import"./dropdown-menu-DWIT9g2E.js";import"./index-BfMh8EvQ.js";import"./index-CJpv9kZ5.js";import"./avatar-CLHvFKAC.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./dollar-sign-OeXEXPCy.js";import"./app-logo-icon-2MFPo7KO.js";import"./toast-lvG1LsW6.js";function ye({steps:u,currentStep:h,className:_}){return e.jsx("div",{className:W("mb-6",_),children:e.jsx("div",{className:"flex items-center justify-between",children:u.map((P,v)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:W("w-8 h-8 rounded-full flex items-center justify-center",h===v+1?"bg-indigo-600 text-white":h>v+1?"bg-green-500 text-white":"bg-gray-200 text-gray-600 dark:bg-gray-800"),children:h>v+1?e.jsx(pe,{className:"h-4 w-4"}):v+1}),e.jsx("div",{className:"text-xs mt-2 text-center",children:P.title}),P.description&&e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:P.description})]}),v<u.length-1&&e.jsx("div",{className:W("h-1 w-12 mx-2",h>v+1?"bg-green-500":"bg-gray-200 dark:bg-gray-800")})]},v))})})}function K({step:u,currentStep:h,children:_}){return u!==h?null:e.jsx("div",{className:"space-y-4",children:_})}const R=[{title:"Información Básica",description:"Datos principales del producto"},{title:"Detalles Adicionales",description:"Información complementaria"},{title:"Precios e Impuestos",description:"Configuración de precios"}];function fe({isOpen:u,onClose:h,categories:_,unitTypes:P,igvTypes:v,currencies:U,product:c,onSuccess:S}){const g=!!c,[x,w]=i.useState(1),[l,k]=i.useState({}),[G,L]=i.useState(!1),[I,n]=i.useState(!1),[s,q]=i.useState({code:"Generando código...",name:"",description:"",item_type:"product",unit_price:0,price:0,cost:0,stock:0,unit_type:"NIU",currency:"PEN",igv_type:"10",igv_percentage:18,has_igv:!0,category_id:"",brand:"",model:"",barcode:"",is_active:!0}),a=i.useCallback((r,m)=>{q(o=>({...o,[r]:m}))},[]),V=i.useCallback(r=>{q(r)},[]),f=i.useCallback(()=>{q({code:"Generando código...",name:"",description:"",item_type:"product",unit_price:0,price:0,cost:0,stock:0,unit_type:"NIU",currency:"PEN",igv_type:"10",igv_percentage:18,has_igv:!0,category_id:"",brand:"",model:"",barcode:"",is_active:!0})},[]),A=i.useCallback(async()=>{if(!g)try{L(!0);const r=await $.get("/v1/products/next-code");if(!r.data.success){b.error("Error al obtener el código");return}a("code",r.data.data.code)}catch(r){console.error("Error al obtener el código:",r)}finally{L(!1)}},[g,a]);i.useEffect(()=>{u&&!g&&A()},[u,g,A]);const z=()=>{const r=["code","name","item_type","unit_type"],m={};return r.forEach(o=>{s[o]||(m[o]="Este campo es requerido")}),k(m),Object.keys(m).length===0},C=()=>{const r=["category_id"],m=s.item_type==="product"?["stock"]:[],o=[...r,...m],j={};return o.forEach(D=>{s[D]||(j[D]="Este campo es requerido")}),k(j),Object.keys(j).length===0},E=()=>{const r=["currency","igv_type","igv_percentage","price"],m={};return r.forEach(o=>{typeof s[o]=="number"?s[o]<=0&&(m[o]="El valor debe ser mayor a 0"):s[o]||(m[o]="Este campo es requerido")}),k(m),Object.keys(m).length===0},[O,M]=i.useState(0),[H,B]=i.useState(0),F=i.useCallback(r=>{const o=r*.18,j=r+o;return{basePrice:parseFloat(r.toFixed(2)),igvAmount:parseFloat(o.toFixed(2)),totalPrice:parseFloat(j.toFixed(2))}},[]);i.useEffect(()=>{if(c){const r={code:c.code||"",name:c.name||"",description:c.description||"",item_type:c.item_type||"product",unit_price:c.unit_price||0,price:c.price||0,cost:c.cost||0,stock:c.stock||0,unit_type:c.unit_type||"NIU",currency:c.currency||"PEN",igv_type:c.igv_type||"10",igv_percentage:c.igv_percentage||18,has_igv:c.has_igv!==void 0?c.has_igv:!0,category_id:c.category_id?String(c.category_id):"",brand:c.brand||"",model:c.model||"",barcode:c.barcode||"",is_active:c.is_active!==void 0?c.is_active:!0};V(r)}else f();w(1)},[c,u,f,V]),i.useEffect(()=>{const r=F(Number(s.unit_price));M(r.igvAmount),B(r.totalPrice),a("price",r.totalPrice)},[s.unit_price,F,a]),i.useEffect(()=>{k({})},[x,u]),i.useEffect(()=>{s.item_type==="service"&&(a("stock",0),a("barcode",""),a("brand",""),a("model",""))},[s.item_type,a]);const t=async r=>{var m,o;if(r.preventDefault(),x!==R.length){Q();return}if(E()){n(!0);try{if(g&&c){const j=await $.put(`/v1/products/${c.id}`,s);f(),h(),S&&S(j.data,!0)}else{const j=await $.post("/v1/products",s);f(),h(),S&&S(j.data,!1)}}catch(j){console.error("Error:",j);const D=j;if((o=(m=D.response)==null?void 0:m.data)!=null&&o.errors){k(D.response.data.errors);const ie=Object.values(D.response.data.errors)[0];b.error(ie||"Error al procesar el formulario")}else b.error("Error al procesar la solicitud")}finally{n(!1)}}},d=()=>{f(),w(1),h()},T=r=>{const m=parseFloat(r.target.value)||0;a("unit_price",m);const o=F(m);M(o.igvAmount),B(o.totalPrice),a("price",o.totalPrice)},ee=r=>{a("has_igv",r)},Q=()=>{let r=!1;switch(x){case 1:r=z();break;case 2:r=C();break;case 3:r=E();break;default:r=!0}r&&x<R.length&&w(x+1)},re=()=>{x>1&&w(x-1)},se=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"item_type",children:["Tipo de ítem ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"item_type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:s.item_type,onChange:r=>a("item_type",r.target.value),required:!0,children:[e.jsx("option",{value:"product",children:"Producto"}),e.jsx("option",{value:"service",children:"Servicio"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:s.item_type==="product"?"Bienes físicos que requieren control de inventario y stock":"Servicios que no requieren manejo de inventario"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"code",children:["Código ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{id:"code",value:s.code,onChange:r=>a("code",r.target.value),placeholder:"Generando código...",required:!0,className:l.code?"border-red-500":"",disabled:G||!g}),G&&e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-gray-500 border-t-transparent"})})]}),l.code&&e.jsx("p",{className:"text-sm text-red-500",children:l.code})]}),e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"unit_type",children:["Unidad de medida ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{id:"unit_type",className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background ${l.unit_type?"border-red-500":""}`,value:s.unit_type,onChange:r=>a("unit_type",r.target.value),required:!0,children:P.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),l.unit_type&&e.jsx("p",{className:"text-sm text-red-500",children:l.unit_type}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:s.item_type==="product"?"Unidad física de medida (kg, unidad, metro, etc.)":"Unidad de servicio (horas, sesiones, etc.)"})]})]}),e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"name",children:["Nombre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(N,{id:"name",value:s.name,onChange:r=>a("name",r.target.value),placeholder:s.item_type==="product"?"Nombre del producto":"Nombre del servicio",required:!0,className:l.name?"border-red-500":""}),l.name&&e.jsx("p",{className:"text-sm text-red-500",children:l.name})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"description",children:"Descripción"}),e.jsx("textarea",{id:"description",className:"flex h-20 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:s.description,onChange:r=>a("description",r.target.value),placeholder:s.item_type==="product"?"Descripción detallada del producto":"Descripción detallada del servicio"})]})]}),te=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"category_id",children:["Categoría ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"category_id",className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background ${l.category_id?"border-red-500":""}`,value:s.category_id,onChange:r=>a("category_id",r.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),_.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),l.category_id&&e.jsx("p",{className:"text-sm text-red-500",children:l.category_id})]}),s.item_type==="product"&&e.jsxs("div",{children:[e.jsx(p,{htmlFor:"barcode",children:"Código de barras"}),e.jsx(N,{id:"barcode",value:s.barcode,onChange:r=>a("barcode",r.target.value),placeholder:"Código de barras (opcional)"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Para identificación y control de productos físicos"})]}),s.item_type==="product"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"brand",children:"Marca"}),e.jsx(N,{id:"brand",value:s.brand,onChange:r=>a("brand",r.target.value),placeholder:"Marca del producto (opcional)"})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"model",children:"Modelo"}),e.jsx(N,{id:"model",value:s.model,onChange:r=>a("model",r.target.value),placeholder:"Modelo del producto (opcional)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.item_type==="product"&&e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"stock",children:["Stock ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(N,{id:"stock",type:"number",min:"0",step:"1",value:s.stock,onChange:r=>a("stock",parseInt(r.target.value)||0),required:!0,className:l.stock?"border-red-500":""}),l.stock&&e.jsx("p",{className:"text-sm text-red-500",children:l.stock}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Cantidad disponible en inventario"})]}),e.jsxs("div",{className:s.item_type==="service"?"col-span-2":"",children:[e.jsx(p,{htmlFor:"cost",children:s.item_type==="product"?"Costo de adquisición":"Costo del servicio"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500",children:s.currency==="PEN"?"S/":"$"}),e.jsx(N,{id:"cost",type:"number",min:"0",step:"0.01",className:"pl-8",value:s.cost,onChange:r=>a("cost",parseFloat(r.target.value)||0)})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:s.item_type==="product"?"Costo de compra o fabricación del producto":"Costo asociado a la prestación del servicio"})]})]}),g&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:"is_active",checked:s.is_active,onCheckedChange:r=>a("is_active",!!r)}),e.jsx(p,{htmlFor:"is_active",className:"text-sm font-normal",children:s.item_type==="product"?"Producto activo":"Servicio activo"})]})]}),ae=()=>e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-md border border-gray-200 p-4 dark:border-gray-800",children:[e.jsxs("h3",{className:"mb-2 text-sm font-medium",children:["Configuración de precios e impuestos",s.item_type==="service"&&e.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Servicio)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"currency",children:["Moneda ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{id:"currency",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:s.currency,onChange:r=>a("currency",r.target.value),required:!0,children:U.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"igv_type",children:["Tipo de IGV ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{id:"igv_type",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:s.igv_type,onChange:r=>a("igv_type",r.target.value),required:!0,children:v.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{children:[e.jsxs(p,{htmlFor:"unit_price",children:[s.item_type==="product"?"Valor unitario (sin IGV)":"Precio del servicio (sin IGV)"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-gray-500",children:s.currency==="PEN"?"S/":"$"}),e.jsx(N,{id:"unit_price",type:"number",min:"0",step:"0.01",className:`pl-8 ${l.unit_price?"border-red-500":""}`,value:s.unit_price,onChange:T,required:!0})]}),l.unit_price&&e.jsx("p",{className:"text-sm text-red-500",children:l.unit_price})]})}),e.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[e.jsx(X,{id:"has_igv",checked:s.has_igv,onCheckedChange:ee}),e.jsx(p,{htmlFor:"has_igv",className:"text-sm font-normal",children:"El precio ingresado incluye IGV"})]}),e.jsx("div",{className:"mt-4 rounded-md bg-gray-50 p-3 dark:bg-gray-900",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:s.item_type==="product"?"Valor unitario:":"Precio base:"}),e.jsxs("div",{className:"font-medium",children:[s.currency==="PEN"?"S/ ":"$ ",Number(s.unit_price).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"IGV (18%):"}),e.jsxs("div",{className:"font-medium",children:[s.currency==="PEN"?"S/ ":"$ ",Number(O).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:s.item_type==="product"?"Precio de venta:":"Precio final:"}),e.jsxs("div",{className:"font-medium",children:[s.currency==="PEN"?"S/ ":"$ ",Number(H).toFixed(2)]})]})]})})]})});return e.jsx(ce,{open:u,onOpenChange:d,children:e.jsxs(oe,{className:"sm:max-w-md md:max-w-lg lg:max-w-2xl",children:[e.jsxs(le,{children:[e.jsx(de,{children:g?"Editar Producto":"Nuevo Producto"}),e.jsx(ne,{children:g?"Actualice los datos del producto para la facturación electrónica.":"Ingrese los datos del producto para la facturación electrónica."})]}),e.jsx(ye,{steps:R,currentStep:x}),e.jsxs("div",{className:"py-4",children:[e.jsx(K,{step:1,currentStep:x,children:se()}),e.jsx(K,{step:2,currentStep:x,children:te()}),e.jsx(K,{step:3,currentStep:x,children:ae()}),e.jsxs(me,{className:"mt-6",children:[x>1&&e.jsx(y,{type:"button",variant:"outline",onClick:re,disabled:I,children:"Anterior"}),x<R.length?e.jsx(y,{type:"button",onClick:Q,disabled:I,children:"Siguiente"}):e.jsx(y,{type:"button",onClick:t,disabled:I,children:g?"Actualizar Producto":"Guardar Producto"})]})]})]})})}function mr(){const[u,h]=i.useState([]),[_,P]=i.useState([]),[v,U]=i.useState([]),[c,S]=i.useState([]),[g,x]=i.useState([]),[w,l]=i.useState(!0),[k,G]=i.useState(null),[L,I]=i.useState(0),[n,s]=i.useState({search:"",category_id:null,sort_field:"name",sort_order:"asc"}),[q,a]=i.useState(!1),[V,f]=i.useState(void 0);i.useEffect(()=>{A()},[n]);const A=async()=>{try{l(!0);const t=await $.get("/v1/products",{params:n});h(t.data.products.data||[]),I(t.data.products.total),P(t.data.categories||[]),U(t.data.unit_types||[]),S(t.data.igv_types||[]),x(t.data.currencies||[])}catch(t){console.error("Error al cargar productos:",t),G("Error al cargar los productos"),b.error("Error al cargar los productos")}finally{l(!1)}},z=t=>{t.preventDefault(),s(d=>({...d,search:d.search,category_id:d.category_id}))},C=t=>{s(d=>({...d,sort_field:t,sort_order:d.sort_field===t&&d.sort_order==="asc"?"desc":"asc"}))},E=()=>{f(void 0),a(!0)},O=t=>{f(t),a(!0)},M=()=>{f(void 0),a(!1)},H=async(t,d=!1)=>{try{console.log(d),await A(),d?b.success("Producto actualizado exitosamente"):b.success("Producto creado exitosamente")}catch(T){console.error("Error al recargar productos:",T),b.error("Operación exitosa, pero hubo un error al actualizar la lista")}M()},B=async t=>{if(confirm("¿Está seguro de eliminar este producto?"))try{await $.delete(`/v1/products/${t}`),h(d=>d.filter(T=>T.id!==t)),b.success("Producto eliminado exitosamente")}catch(d){console.error("Error al eliminar el producto:",d),b.error("Error al eliminar el producto")}},F=[{title:"Inicio",href:"/"},{title:"Productos",href:"/products"}];return k?e.jsx(Y,{breadcrumbs:F,children:e.jsx("div",{className:"p-4 text-center text-red-500",children:k})}):e.jsxs(Y,{breadcrumbs:F,children:[e.jsxs("div",{className:"flex flex-1 flex-col gap-4 p-4 md:gap-8 md:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Productos"}),e.jsxs(y,{onClick:E,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Nuevo Producto"]})]}),e.jsxs(xe,{children:[e.jsx(ue,{className:"pb-3",children:e.jsxs("form",{onSubmit:z,className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(N,{type:"search",placeholder:"Buscar productos...",className:"w-full appearance-none bg-background pl-8 shadow-none md:w-2/3 lg:w-1/3",value:n.search,onChange:t=>s(d=>({...d,search:t.target.value}))})]}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",value:n.category_id||"",onChange:t=>s(d=>({...d,category_id:t.target.value||null})),children:[e.jsx("option",{value:"",children:"Todas las categorías"}),_.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(y,{type:"submit",variant:"secondary",children:"Buscar"})]})}),e.jsx(he,{children:e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50 text-left text-xs font-medium text-muted-foreground",children:[e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("id"),children:["ID",n.sort_field==="id"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("code"),children:["Código",n.sort_field==="code"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("name"),children:["Producto",n.sort_field==="name"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("price"),children:["Precio",n.sort_field==="price"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("stock"),children:["Stock",n.sort_field==="stock"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsx("th",{className:"px-4 py-3",children:"Categoría"}),e.jsxs("th",{className:"cursor-pointer px-4 py-3",onClick:()=>C("created_at"),children:["Fecha de Registro",n.sort_field==="created_at"&&e.jsx("span",{className:"ml-1",children:n.sort_order==="asc"?"↑":"↓"})]}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Acciones"})]})}),e.jsx("tbody",{children:w?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-4 text-center",children:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})})})}):u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-400"}),L===0?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No hay productos registrados"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Para comenzar a usar el sistema, necesitas registrar al menos un producto."}),e.jsx("div",{className:"mt-6",children:e.jsxs(y,{onClick:E,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Registrar Primer Producto"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No se encontraron resultados"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"No hay productos que coincidan con los filtros aplicados."}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2 sm:flex-row",children:[e.jsx(y,{variant:"outline",onClick:()=>s({search:"",category_id:null,sort_field:"name",sort_order:"asc"}),children:"Limpiar filtros"}),e.jsxs(y,{onClick:E,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Nuevo Producto"]})]})]})]})})}):u.map(t=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:t.id}),e.jsx("td",{className:"px-4 py-3",children:t.code}),e.jsxs("td",{className:"flex items-center gap-2 px-4 py-3",children:[e.jsx(Z,{className:"h-5 w-5 text-muted-foreground"}),t.name]}),e.jsxs("td",{className:"px-4 py-3",children:["S/ ",Number(t.price).toFixed(2)]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium ${t.stock>10?"bg-green-100 text-green-800 dark:bg-green-800/20 dark:text-green-400":t.stock>0?"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/20 dark:text-yellow-400":"bg-red-100 text-red-800 dark:bg-red-800/20 dark:text-red-400"}`,children:t.stock})}),e.jsx("td",{className:"px-4 py-3",children:t.category?e.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800 dark:bg-blue-800/20 dark:text-blue-400",children:t.category.name}):"-"}),e.jsx("td",{className:"px-4 py-3",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(y,{variant:"ghost",size:"icon",onClick:()=>O(t),children:[e.jsx(je,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Editar"})]}),e.jsxs(y,{variant:"ghost",size:"icon",className:"text-red-500",onClick:()=>B(t.id),children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Eliminar"})]})]})})]},t.id))})]})})})})]})]}),e.jsx(fe,{isOpen:q,onClose:M,categories:_,unitTypes:v,igvTypes:c,currencies:g,product:V,onSuccess:H})]})}export{mr as default};
