import{r as x,j as e}from"./app-DQczwFTk.js";import{B as o}from"./button-BYXnJyXv.js";import{D as b,a as v,b as S,c as C,d as w}from"./dialog-DHq7tLZ5.js";import{I as d}from"./input-goWATpHJ.js";import{L as r}from"./label-BchK1h47.js";import{S as y,a as _,b as D,c as I,d as h}from"./select-D52pRjk-.js";import{S as T}from"./switch-x9PZ-zT7.js";import{I as P}from"./image-dropzone-B7t8X9ae.js";import{T as u}from"./textarea-DHAakLHN.js";import{B as k}from"./badge-CIPxAGrn.js";import"./app-C-su-A41.js";import"./index-D2mu7mBH.js";import"./utils-CPN-yreq.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-CTC3mW-r.js";import"./index-BVHM8iLO.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-BfMh8EvQ.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./chevron-down-Bqmppv4h.js";import"./card-BNPG6E-E.js";import"./index-Cou6Ygo0.js";import"./trash-2-b2Qe_qpo.js";function de({news:p=[],value:n,onChange:m,onCreateNew:g,usedItems:j=[]}){const[N,c]=x.useState(!1),[i,t]=x.useState({title:"",slug:"",excerpt:"",content:"",published_at:new Date().toISOString().split("T")[0],is_published:!0,image:null}),l=p.find(s=>s.id===n)||null,f=async()=>{try{const s=new FormData;s.append("title",i.title),s.append("slug",i.slug||""),s.append("excerpt",i.excerpt||""),s.append("content",i.content||""),s.append("published_at",i.published_at),s.append("is_published",i.is_published?"1":"0"),i.image&&s.append("image",i.image);const a=await g(s);m(a),c(!1),t({title:"",slug:"",excerpt:"",content:"",published_at:new Date().toISOString().split("T")[0],is_published:!0,image:null})}catch(s){console.error("Error creating News:",s)}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{children:"Seleccionar Noticia"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{value:(n==null?void 0:n.toString())??"none",onValueChange:s=>m(s==="none"?null:parseInt(s)),children:[e.jsx(_,{className:"flex-1",children:e.jsx(D,{placeholder:"Selecciona una noticia"})}),e.jsxs(I,{children:[e.jsx(h,{value:"none",children:"Ninguna (crear nueva)"}),p.map(s=>{const a=j.includes(s.id)&&s.id!==n;return e.jsx(h,{value:s.id.toString(),disabled:a,className:"relative",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:s.title||"Sin título"}),a&&e.jsx(k,{variant:"secondary",className:"ml-2",children:"Usado"})]})},s.id)})]})]}),e.jsxs(b,{open:N,onOpenChange:c,children:[e.jsx(v,{asChild:!0,children:e.jsx(o,{variant:"outline",disabled:!!n,children:"Crear Nueva"})}),e.jsxs(S,{className:"max-w-2xl",children:[e.jsx(C,{children:e.jsx(w,{children:"Nueva Noticia"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(r,{children:"Imagen de Portada"}),e.jsx(P,{image:i.image,onImageChange:s=>t(a=>({...a,image:s})),collectionName:"news_covers",title:"Portada de la noticia",description:"Imagen principal que aparecerá en el listado"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Título"}),e.jsx(d,{value:i.title,onChange:s=>t(a=>({...a,title:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Slug"}),e.jsx(d,{value:i.slug,onChange:s=>t(a=>({...a,slug:s.target.value})),placeholder:"Se generará automáticamente si se deja vacío"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Resumen"}),e.jsx(u,{value:i.excerpt,onChange:s=>t(a=>({...a,excerpt:s.target.value})),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Contenido"}),e.jsx(u,{value:i.content,onChange:s=>t(a=>({...a,content:s.target.value})),rows:6})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Fecha de Publicación"}),e.jsx(d,{type:"date",value:i.published_at,onChange:s=>t(a=>({...a,published_at:s.target.value}))})]}),e.jsxs("div",{className:"flex items-center justify-between space-y-2",children:[e.jsx(r,{children:"Publicado"}),e.jsx(T,{checked:i.is_published,onCheckedChange:s=>t(a=>({...a,is_published:s}))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(o,{onClick:f,children:"Crear Noticia"})]})]})]})]}),l&&e.jsxs("div",{className:"border p-4 rounded-md space-y-2 bg-muted/50",children:[l.image&&e.jsx("img",{src:l.image,alt:l.title,className:"w-full h-40 object-cover rounded-md mb-2"}),e.jsx("h4",{className:"font-semibold",children:l.title}),e.jsx("p",{className:"text-sm",children:l.excerpt}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Publicado: ",l.published_at||"Sin fecha"]}),e.jsxs("span",{children:["Estado: ",l.is_published?"Publicado":"No publicado"]})]})]})]})}export{de as NewsSelector};
