import{r as t,a as i,j as e,H as ve}from"./app-DQczwFTk.js";import{B as n}from"./button-BYXnJyXv.js";import{I as c}from"./input-goWATpHJ.js";import{L as m}from"./label-BchK1h47.js";import{D as S,b as C,c as T,d as D,e as _,f as M}from"./dialog-DHq7tLZ5.js";import{D as X,a as Y,b as $,c as w}from"./dropdown-menu-DWIT9g2E.js";import{T as q,a as K,b as h,c as l,d as Q,e as r}from"./table-J6M9UKS6.js";import{T as ye,a as we,b as Z,c as ee}from"./tabs-C6TkS0W8.js";import{S as Ne,a as be,b as Se,c as Ce,d as j}from"./select-D52pRjk-.js";import{C as Te}from"./card-BNPG6E-E.js";import{t as d}from"./index-Cou6Ygo0.js";import{b as F}from"./utils-CPN-yreq.js";import{A as De}from"./app-layout-CxNCz1W0.js";import{U as _e}from"./upload-CveXEXwr.js";import{c as re}from"./createLucideIcon-D40S4Mwt.js";import{T as se}from"./trash-2-b2Qe_qpo.js";import{R as Me}from"./refresh-cw-DLTUYBNZ.js";import{X as Fe}from"./x-CNv1352c.js";import"./app-C-su-A41.js";import"./index-D2mu7mBH.js";import"./index-CnB8Y-kE.js";import"./index-CTC3mW-r.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-BVHM8iLO.js";import"./index-BfMh8EvQ.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-CJpv9kZ5.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./chevron-down-Bqmppv4h.js";import"./tenant-status-listener-Bzjk6yNz.js";import"./toast-lvG1LsW6.js";import"./app-sidebar-layout-DjIGW_b8.js";import"./avatar-CLHvFKAC.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./dollar-sign-OeXEXPCy.js";import"./search-DPYN2drD.js";import"./app-logo-icon-2MFPo7KO.js";import"./cookie-consent-DYpW6VIi.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],ae=re("EllipsisVertical",ke);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],te=re("Image",Ee);function Ms({auth:Ue,media:x,filters:p}){const[u,le]=t.useState(p.trashed==="only"?"trash":"gallery"),[ie,g]=t.useState(!1),[ne,f]=t.useState(!1),[de,v]=t.useState(!1),[k,E]=t.useState(null),[o,N]=t.useState([]),[U,I]=t.useState(""),[L,A]=t.useState(!1),[y,z]=t.useState(""),[b,O]=t.useState(""),[P,R]=t.useState(""),[V,H]=t.useState(""),[B,W]=t.useState("{}"),G=x.data.filter(s=>!s.deleted_at),J=x.data.filter(s=>s.deleted_at);t.useEffect(()=>{const s=u==="trash"?"only":"without";i.get(route("admin.media.index"),{...p,trashed:s},{preserveState:!0})},[u]);const oe=s=>{const a=s==="trash"?"only":"without";i.get(route("admin.media.index"),{trashed:a},{preserveState:!0,replace:!0}),le(s)},ce=s=>{s.target.files&&s.target.files.length>0&&N([s.target.files[0]])},me=()=>{N([])},he=async s=>{s.preventDefault(),A(!0);try{const a=new FormData;o.length>0&&a.append("file",o[0],o[0].name),y.trim()&&a.append("external_url",y),a.append("collection_name",b),a.append("model_type",P),a.append("model_id",V),a.append("custom_properties",B),await i.post(route("admin.media.store"),a,{forceFormData:!0,onSuccess:()=>{d.success("Media uploaded successfully"),g(!1),xe()},onError:fe=>{d.error("Failed to upload media",{description:Object.values(fe).join(`
`)})}})}finally{A(!1)}},xe=()=>{N([]),z(""),O(""),R(""),H(""),W("{}")},pe=async s=>{s.preventDefault(),await i.put(route("admin.media.update",k.id),{name:U},{onSuccess:()=>{d.success("Media updated successfully"),f(!1)},onError:()=>{d.error("Failed to update media")}})},ue=async()=>{await i.delete(route("admin.media.destroy",k.id),{onSuccess:()=>{d.success("Media moved to trash"),v(!1)},onError:()=>{d.error("Failed to move media to trash")}})},je=async s=>{await i.post(route("admin.media.restore",s),{},{onSuccess:()=>{d.success("Media restored"),i.visit(route("admin.media.index",{trashed:"only"}),{preserveState:!0,only:["media"],onFinish:()=>{window.scrollTo(0,0)}})},onError:()=>{d.error("Failed to restore media")}})},ge=async s=>{confirm("¿Estás seguro de eliminar permanentemente este archivo?")&&await i.delete(route("admin.media.forceDelete",s),{onSuccess:()=>{d.success("Media permanently deleted"),i.visit(route("admin.media.index",{trashed:"only"}),{preserveState:!0,only:["media"],onFinish:()=>{window.scrollTo(0,0)}})},onError:()=>{d.error("Failed to delete media permanently")}})};return e.jsxs(De,{children:[e.jsx(ve,{title:"Media Library"}),e.jsx("div",{className:"py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx(Te,{className:"overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs(ye,{value:u,onValueChange:oe,className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs(we,{children:[e.jsx(Z,{value:"gallery",children:"Gallery"}),e.jsx(Z,{value:"trash",children:"Trash"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(c,{placeholder:"Search media...",value:p.search||"",onChange:s=>i.get(route("admin.media.index"),{...p,search:s.target.value,trashed:u==="trash"?"only":"without"},{preserveState:!0}),className:"max-w-sm"}),e.jsxs(n,{onClick:()=>g(!0),children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Upload"]})]})]}),e.jsx(ee,{value:"gallery",children:e.jsx("div",{className:"mt-4 rounded-md border",children:e.jsxs(q,{children:[e.jsx(K,{children:e.jsxs(h,{children:[e.jsx(l,{className:"w-[100px]",children:"Preview"}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Size"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Uploaded"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:G.length>0?G.map(s=>{var a;return e.jsxs(h,{children:[e.jsx(r,{children:e.jsx("div",{className:"w-16 h-16 rounded-md overflow-hidden border",children:(a=s.mime_type)!=null&&a.startsWith("image/")?e.jsx("img",{src:s.thumbnail||s.original_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx(te,{className:"h-8 w-8 text-gray-400"})})})}),e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{children:F(s.size)}),e.jsx(r,{children:s.mime_type}),e.jsx(r,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(r,{className:"text-right",children:e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(n,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs($,{align:"end",children:[e.jsx(w,{onClick:()=>{E(s),I(s.name),f(!0)},children:"Edit"}),e.jsxs(w,{onClick:()=>{E(s),v(!0)},className:"text-red-600",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},s.id)}):e.jsx(h,{children:e.jsx(r,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No media found"})})})]})})}),e.jsx(ee,{value:"trash",children:e.jsx("div",{className:"mt-4 rounded-md border",children:e.jsxs(q,{children:[e.jsx(K,{children:e.jsxs(h,{children:[e.jsx(l,{className:"w-[100px]",children:"Preview"}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Size"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Deleted"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:J.length>0?J.map(s=>{var a;return e.jsxs(h,{children:[e.jsx(r,{children:e.jsx("div",{className:"w-16 h-16 rounded-md overflow-hidden border",children:(a=s.mime_type)!=null&&a.startsWith("image/")?e.jsx("img",{src:s.thumbnail||s.original_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:e.jsx(te,{className:"h-8 w-8 text-gray-400"})})})}),e.jsx(r,{className:"font-medium",children:s.name}),e.jsx(r,{children:F(s.size)}),e.jsx(r,{children:s.mime_type}),e.jsx(r,{children:new Date(s.deleted_at).toLocaleDateString()}),e.jsx(r,{className:"text-right",children:e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(n,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs($,{align:"end",children:[e.jsxs(w,{onClick:()=>je(s.id),children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Restore"]}),e.jsxs(w,{onClick:()=>ge(s.id),className:"text-red-600",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Delete Permanently"]})]})]})})]},s.id)}):e.jsx(h,{children:e.jsx(r,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"Trash is empty"})})})]})})})]}),x.links&&x.links.length>3&&e.jsx("div",{className:"mt-4 flex items-center justify-end space-x-2",children:x.links.map((s,a)=>e.jsx(n,{variant:s.active?"default":"outline",size:"sm",onClick:()=>s.url&&i.get(s.url,{...p,trashed:u==="trash"?"only":"without"},{preserveState:!0}),disabled:!s.url,children:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},a))})]})})})})}),e.jsx(S,{open:ie,onOpenChange:g,children:e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(D,{children:"Upload Media"}),e.jsx(_,{children:"Select a file to upload to your media library"})]}),e.jsxs("form",{onSubmit:he,children:[e.jsxs("div",{className:"grid gap-4 py-4 max-w-sm",children:[e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"file",children:"File"}),e.jsx(c,{id:"file",type:"file",onChange:ce}),o.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:[o[0].name," (",F(o[0].size),")"]}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",onClick:me,children:e.jsx(Fe,{className:"h-4 w-4"})})]})})]}),e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"external_url",children:"External URL (Alternative to file)"}),e.jsx(c,{id:"external_url",type:"url",value:y,onChange:s=>z(s.target.value),placeholder:"https://example.com/media.jpg"})]}),e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"collection_name",children:"Collection Name *"}),e.jsxs(Ne,{value:b,onValueChange:O,children:[e.jsx(be,{children:e.jsx(Se,{placeholder:"Select collection"})}),e.jsxs(Ce,{children:[e.jsx(j,{value:"default",children:"Default"}),e.jsx(j,{value:"images",children:"Images"}),e.jsx(j,{value:"videos",children:"Videos"}),e.jsx(j,{value:"documents",children:"Documents"}),e.jsx(j,{value:"thumbnails",children:"Thumbnails"})]})]})]}),e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"model_type",children:"Model Type (Optional)"}),e.jsx(c,{id:"model_type",type:"text",value:P,onChange:s=>R(s.target.value),placeholder:"e.g. App\\\\Models\\\\Post"})]}),e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"model_id",children:"Model ID (Optional)"}),e.jsx(c,{id:"model_id",type:"number",value:V,onChange:s=>H(s.target.value),placeholder:"123"})]}),e.jsxs("div",{className:"grid items-center gap-1.5",children:[e.jsx(m,{htmlFor:"custom_properties",children:"Custom Properties (JSON)"}),e.jsx(c,{id:"custom_properties",type:"text",value:B,onChange:s=>W(s.target.value),placeholder:'{"key": "value"}'})]})]}),e.jsxs(M,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:o.length===0&&y.trim()===""||!b||L,children:L?"Uploading...":"Upload"})]})]})]})}),e.jsx(S,{open:ne,onOpenChange:f,children:e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(D,{children:"Edit Media"}),e.jsx(_,{children:"Update the details for this media file"})]}),e.jsxs("form",{onSubmit:pe,children:[e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx(m,{htmlFor:"name",children:"Name"}),e.jsx(c,{id:"name",value:U,onChange:s=>I(s.target.value)})]})}),e.jsxs(M,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(n,{type:"submit",children:"Save"})]})]})]})}),e.jsx(S,{open:de,onOpenChange:v,children:e.jsxs(C,{children:[e.jsxs(T,{children:[e.jsx(D,{children:"Are you absolutely sure?"}),e.jsx(_,{children:"This action will move the media file to trash. You can restore it later."})]}),e.jsxs(M,{children:[e.jsx(n,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:ue,children:"Move to Trash"})]})]})})]})}export{Ms as default};
