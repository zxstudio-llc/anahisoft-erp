import{r as x,j as e,H as O,a as T}from"./app-DQczwFTk.js";import{A as P}from"./app-layout-CxNCz1W0.js";import{L as c}from"./label-BchK1h47.js";import{I as r}from"./input-goWATpHJ.js";import{B as W}from"./button-BYXnJyXv.js";import{I as J}from"./image-dropzone-B7t8X9ae.js";import{S as M}from"./switch-x9PZ-zT7.js";import{C as A,d as $,a as q,b as G}from"./card-BNPG6E-E.js";import"./app-C-su-A41.js";import"./tenant-status-listener-Bzjk6yNz.js";import"./index-Cou6Ygo0.js";import"./index-CTC3mW-r.js";import"./toast-lvG1LsW6.js";import"./app-sidebar-layout-DjIGW_b8.js";import"./index-D2mu7mBH.js";import"./utils-CPN-yreq.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-BVHM8iLO.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-CX1ZUDb2.js";import"./dropdown-menu-DWIT9g2E.js";import"./index-BfMh8EvQ.js";import"./index-CJpv9kZ5.js";import"./avatar-CLHvFKAC.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./dollar-sign-OeXEXPCy.js";import"./search-DPYN2drD.js";import"./app-logo-icon-2MFPo7KO.js";import"./cookie-consent-DYpW6VIi.js";import"./trash-2-b2Qe_qpo.js";import"./index-7Ou4doz_.js";const K=[{label:"1024x256 (4:1)",width:1024,height:256},{label:"1024x300 (24:7)",width:1024,height:300},{label:"1024x384 (8:3)",width:1024,height:384},{label:"1024x768 (4:3)",width:1024,height:768},{label:"1280x267 (24:5)",width:1280,height:267},{label:"1280x375 (24:7)",width:1280,height:375},{label:"1280x400 (16:5)",width:1280,height:400},{label:"1280x800 (8:5)",width:1280,height:800},{label:"1366x256 (16:3)",width:1366,height:256},{label:"1366x384 (32:9)",width:1366,height:384},{label:"1366x768 (16:9)",width:1366,height:768},{label:"1440x300 (24:7)",width:1440,height:300},{label:"1440x450 (16:5)",width:1440,height:450},{label:"1440x900 (8:5)",width:1440,height:900},{label:"1600x300 (16:3)",width:1600,height:300},{label:"1600x450 (32:9)",width:1600,height:450},{label:"1600x900 (16:9)",width:1600,height:900},{label:"1920x360 (16:3)",width:1920,height:360},{label:"1920x540 (32:9)",width:1920,height:540},{label:"1920x1080 (16:9)",width:1920,height:1080}];function He({banner:s}){var _,I,C,y,F,S,E,k;console.log("Banner data:",s);const L=s.width||1024,R=s.height||256,[w,m]=x.useState(null),[v,j]=x.useState(s.image_url||null),[o,d]=x.useState(null),[u,b]=x.useState(!1),[a,h]=x.useState({width:L,height:R,title:s.title||"",subtitle:s.subtitle||"",link:s.link||"",cta:s.cta||{cta_1:{name:"",url:""},cta_2:{name:"",url:""}},is_active:s.is_active||!1,published_at:s.published_at||""}),N=K.find(l=>l.width===a.width&&l.height===a.height),g=l=>{const{name:t,type:i,checked:n,value:p}=l.target;h(f=>({...f,[t]:i==="checkbox"?n:p}))},D=l=>{if(m(null),b(!1),!l){d(null);return}const t=new Image;t.onload=()=>{const{width:i,height:n}=t,p=a.width,f=a.height;i===p&&n===f?(d(l),m(null)):(m(`La imagen debe tener dimensiones exactas de ${p}x${f} px. La imagen seleccionada tiene ${i}x${n} px.`),d(null))},t.onerror=()=>{m("No se pudo validar la imagen seleccionada."),d(null)},t.src=URL.createObjectURL(l)},U=()=>{console.log("Remove image called"),j(null),d(null),b(!0),m(null),console.log("Image removal state set:",{removeImage:!0})},z=l=>{l.preventDefault();const t=new FormData;console.log("Form state before submit:",{form:a,newImage:o,removeImage:u,currentImage:v}),Object.entries(a).forEach(([i,n])=>{i==="cta"?t.append("cta",JSON.stringify(n)):n!=null&&t.append(i,n)}),u?(t.append("remove_image","1"),console.log("Adding remove_image flag")):o&&(t.append("image",o),console.log("Adding new image file:",o.name)),t.append("is_active",a.is_active?"1":"0"),t.append("_method","PUT"),console.log("FormData entries:");for(let[i,n]of t.entries())console.log(i,n);T.post(`/admin/banners/${s.id}`,t,{forceFormData:!0,onSuccess:i=>{console.log("Update successful",i),u?(j(null),b(!1)):o&&(j(URL.createObjectURL(o)),d(null))},onError:i=>{console.error("Update failed:",i)}})},B=N?`${N.label} (Ancho: ${a.width}px, Alto: ${a.height}px)`:`Personalizado (Ancho: ${a.width}px, Alto: ${a.height}px)`,H=o||(u?null:v);return e.jsxs(P,{breadcrumbs:[{title:"Dashboard",href:"/admin/dashboard"},{title:"Editar Banner",href:`/admin/banners/${s.id}/edit`}],children:[e.jsx(O,{title:"Editar banner"}),e.jsxs("div",{className:"flex-1 space-y-6 p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Editar Banner"}),e.jsx("p",{className:"text-muted-foreground",children:"Modifica los datos del banner seleccionado."})]}),e.jsx(W,{type:"submit",form:"banner-form",children:"Actualizar"})]}),e.jsxs("form",{onSubmit:z,id:"banner-form",className:"flex flex-col 2xl:flex-row gap-8",children:[e.jsx(A,{className:"w-full 2xl:w-7/9",children:e.jsx($,{className:"space-y-4",children:e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Dimensión del banner"}),e.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[e.jsx("p",{className:"text-sm",children:B}),e.jsx("input",{type:"hidden",name:"width",value:a.width}),e.jsx("input",{type:"hidden",name:"height",value:a.height})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(c,{htmlFor:"image",className:"hidden",children:"Imagen"}),e.jsx("div",{className:"w-full",children:e.jsx(J,{image:o,defaultImage:H,onImageChange:D,onRemoveImage:U,collectionName:"banners_covers",title:"Imagen del banner",description:"Imagen actual o selecciona una nueva"})}),w&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:w}),o&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Archivo seleccionado: ",o.name]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"title",children:"Título"}),e.jsx(r,{id:"title",name:"title",value:a.title,onChange:g})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"subtitle",children:"Subtítulo"}),e.jsx(r,{id:"subtitle",name:"subtitle",value:a.subtitle,onChange:g})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"link",children:"Enlace"}),e.jsx(r,{id:"link",name:"link",type:"url",value:a.link,onChange:g,placeholder:"https://ejemplo.com"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(c,{htmlFor:"cta_1",children:"Nombre"}),e.jsx(r,{className:"w-full",value:((I=(_=a.cta)==null?void 0:_.cta_1)==null?void 0:I.name)||"",onChange:l=>h(t=>({...t,cta:{...t.cta,cta_1:{...t.cta.cta_1,name:l.target.value}}}))})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(c,{htmlFor:"url_1",children:"Enlace"}),e.jsx(r,{className:"w-full",value:((y=(C=a.cta)==null?void 0:C.cta_1)==null?void 0:y.url)||"",onChange:l=>h(t=>({...t,cta:{...t.cta,cta_1:{...t.cta.cta_1,url:l.target.value}}}))})]})]}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(c,{htmlFor:"cta2",children:"Nombre"}),e.jsx(r,{className:"w-full",value:((S=(F=a.cta)==null?void 0:F.cta_2)==null?void 0:S.name)||"",onChange:l=>h(t=>({...t,cta:{...t.cta,cta_2:{...t.cta.cta_2,name:l.target.value}}}))})]}),e.jsxs("div",{className:"w-full",children:[e.jsx(c,{htmlFor:"url_2",children:"Enlace"}),e.jsx(r,{className:"w-full",value:((k=(E=a.cta)==null?void 0:E.cta_2)==null?void 0:k.url)||"",onChange:l=>h(t=>({...t,cta:{...t.cta,cta_2:{...t.cta.cta_2,url:l.target.value}}}))})]})]})]})]})]})})}),e.jsx("div",{className:"w-full 2xl:w-2/9",children:e.jsxs(A,{className:"space-y-4",children:[e.jsx(q,{children:e.jsx(G,{children:"Opciones"})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"published_at",children:"Fecha de publicación"}),e.jsx(r,{id:"published_at",name:"published_at",type:"datetime-local",value:a.published_at,onChange:g})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{htmlFor:"is_active",children:"Activo"}),e.jsx(M,{id:"is_active",checked:a.is_active,onCheckedChange:l=>h(t=>({...t,is_active:l}))})]})]})]})})]})]})]})}export{He as default};
