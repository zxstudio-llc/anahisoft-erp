import{r as f,j as e,H as A,a as g,L as q,b as R}from"./app-DQczwFTk.js";import{B as b}from"./badge-CIPxAGrn.js";import{B as v}from"./button-BYXnJyXv.js";import{C as z,a as G,b as O,c as k,d as $}from"./card-BNPG6E-E.js";import{D as J,a as K,b as Q,c as U,d as W,e as X,f as Y}from"./dialog-DHq7tLZ5.js";import{I as _}from"./input-goWATpHJ.js";import{L as n}from"./label-BchK1h47.js";import{S as o,a as c,b as m,c as x,d as r}from"./select-D52pRjk-.js";import{T as Z,a as ee,b as C,c as d,d as se,e as l}from"./table-J6M9UKS6.js";import{A as ae}from"./app-layout-CxNCz1W0.js";import{t as V}from"./index-Cou6Ygo0.js";import{P as re}from"./plus-BGuKkasZ.js";import{S as te}from"./search-DPYN2drD.js";import{D as le}from"./dollar-sign-OeXEXPCy.js";import"./app-C-su-A41.js";import"./index-D2mu7mBH.js";import"./utils-CPN-yreq.js";import"./index-DcW1-0jE.js";import"./index-BBPPPnEU.js";import"./index-KJ4lOR0W.js";import"./index-CqVE9Fls.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-CTC3mW-r.js";import"./index-BVHM8iLO.js";import"./x-CNv1352c.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-BfMh8EvQ.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./chevron-down-Bqmppv4h.js";import"./tenant-status-listener-Bzjk6yNz.js";import"./toast-lvG1LsW6.js";import"./app-sidebar-layout-DjIGW_b8.js";import"./dropdown-menu-DWIT9g2E.js";import"./index-CJpv9kZ5.js";import"./avatar-CLHvFKAC.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./app-logo-icon-2MFPo7KO.js";import"./cookie-consent-DYpW6VIi.js";const ie=[{title:"Dashboard",href:route("dashboard")}];function es({payments:h,tenants:L,subscription_plans:D,filters:N,payment_statuses:F,payment_methods:B}){const[E,y]=f.useState(!1),[t,w]=f.useState({tenant_id:"",subscription_plan_id:"",payment_method:"bank_transfer",amount:"",payment_date:new Date().toISOString().split("T")[0],billing_period:"monthly",status:"completed",notes:""}),[a,P]=f.useState({}),[T,I]=f.useState(!1),S=s=>{const{name:i,value:p}=s.target;w(j=>({...j,[i]:p}))},u=(s,i)=>{w(p=>({...p,[s]:i}))},H=async s=>{var i,p;s.preventDefault(),I(!0),P({});try{await R.post(route("admin.payments.store"),t),y(!1),V.success("Pago registrado correctamente"),g.reload()}catch(j){R.isAxiosError(j)&&((p=(i=j.response)==null?void 0:i.data)!=null&&p.errors)&&P(j.response.data.errors),V.error("Error al registrar el pago")}finally{I(!1)}},M=s=>{switch(s){case"completed":return e.jsx(b,{className:"bg-green-500",children:"Completado"});case"pending":return e.jsx(b,{className:"bg-yellow-500",children:"Pendiente"});case"failed":return e.jsx(b,{className:"bg-red-500",children:"Fallido"});case"refunded":return e.jsx(b,{className:"bg-blue-500",children:"Reembolsado"});default:return e.jsx(b,{children:s})}};return e.jsx(e.Fragment,{children:e.jsx(ae,{breadcrumbs:ie,children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(A,{title:"Gestión de Pagos"}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestión de Pagos"}),e.jsxs(J,{open:E,onOpenChange:y,children:[e.jsx(K,{asChild:!0,children:e.jsxs(v,{children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Registrar Pago"]})}),e.jsx(Q,{className:"sm:max-w-[550px]",children:e.jsxs("form",{onSubmit:H,children:[e.jsxs(U,{children:[e.jsx(W,{children:"Registrar Nuevo Pago"}),e.jsx(X,{children:"Complete los detalles del pago para registrarlo en el sistema."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tenant_id",children:"Inquilino"}),e.jsxs(o,{name:"tenant_id",value:t.tenant_id,onValueChange:s=>u("tenant_id",s),required:!0,children:[e.jsx(c,{children:e.jsx(m,{placeholder:"Seleccione un inquilino"})}),e.jsx(x,{children:L.map(s=>e.jsx(r,{value:s.id,children:s.company_name},s.id))})]}),a.tenant_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.tenant_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"subscription_plan_id",children:"Plan de Suscripción"}),e.jsxs(o,{name:"subscription_plan_id",value:t.subscription_plan_id,onValueChange:s=>u("subscription_plan_id",s),required:!0,children:[e.jsx(c,{children:e.jsx(m,{placeholder:"Seleccione un plan"})}),e.jsx(x,{children:D.map(s=>e.jsx(r,{value:s.id.toString(),children:s.name},s.id))})]}),a.subscription_plan_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.subscription_plan_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"amount",children:"Monto"}),e.jsx(_,{id:"amount",name:"amount",type:"number",step:"0.01",value:t.amount,onChange:S,required:!0}),a.amount&&e.jsx("p",{className:"text-sm text-red-500",children:a.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"payment_date",children:"Fecha de Pago"}),e.jsx(_,{id:"payment_date",name:"payment_date",type:"date",value:t.payment_date,onChange:S,required:!0}),a.payment_date&&e.jsx("p",{className:"text-sm text-red-500",children:a.payment_date})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"payment_method",children:"Método de Pago"}),e.jsxs(o,{name:"payment_method",value:t.payment_method,onValueChange:s=>u("payment_method",s),required:!0,children:[e.jsx(c,{children:e.jsx(m,{placeholder:"Seleccione un método"})}),e.jsx(x,{children:B.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]}),a.payment_method&&e.jsx("p",{className:"text-sm text-red-500",children:a.payment_method})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"billing_period",children:"Período de Facturación"}),e.jsxs(o,{name:"billing_period",value:t.billing_period,onValueChange:s=>u("billing_period",s),required:!0,children:[e.jsx(c,{children:e.jsx(m,{placeholder:"Seleccione un período"})}),e.jsxs(x,{children:[e.jsx(r,{value:"monthly",children:"Mensual"}),e.jsx(r,{value:"yearly",children:"Anual"})]})]}),a.billing_period&&e.jsx("p",{className:"text-sm text-red-500",children:a.billing_period})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"status",children:"Estado"}),e.jsxs(o,{name:"status",value:t.status,onValueChange:s=>u("status",s),required:!0,children:[e.jsx(c,{children:e.jsx(m,{placeholder:"Seleccione un estado"})}),e.jsx(x,{children:F.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))})]}),a.status&&e.jsx("p",{className:"text-sm text-red-500",children:a.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notas"}),e.jsx(_,{id:"notes",name:"notes",value:t.notes,onChange:S,placeholder:"Notas adicionales sobre el pago"}),a.notes&&e.jsx("p",{className:"text-sm text-red-500",children:a.notes})]})]}),e.jsxs(Y,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancelar"}),e.jsx(v,{type:"submit",disabled:T,children:T?"Registrando...":"Registrar Pago"})]})]})})]})]}),e.jsxs(z,{children:[e.jsxs(G,{children:[e.jsx(O,{children:"Pagos Registrados"}),e.jsx(k,{children:"Lista de todos los pagos registrados en el sistema."})]}),e.jsxs($,{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(te,{className:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_,{type:"search",placeholder:"Buscar...",className:"w-[250px] pl-8",value:N.search||"",onChange:s=>g.get(route("admin.payments.index"),{search:s.target.value},{preserveState:!0})})]}),e.jsxs(o,{value:N.subscription_plan_id||"all",onValueChange:s=>g.get(route("admin.payments.index"),{subscription_plan_id:s==="all"?"":s},{preserveState:!0}),children:[e.jsx(c,{className:"w-[180px]",children:e.jsx(m,{placeholder:"Filtrar por plan"})}),e.jsxs(x,{children:[e.jsx(r,{value:"all",children:"Todos los planes"}),D.map(s=>e.jsx(r,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(o,{value:N.status||"all",onValueChange:s=>g.get(route("admin.payments.index"),{status:s==="all"?"":s},{preserveState:!0}),children:[e.jsx(c,{className:"w-[180px]",children:e.jsx(m,{placeholder:"Filtrar por estado"})}),e.jsxs(x,{children:[e.jsx(r,{value:"all",children:"Todos los estados"}),F.map(s=>e.jsx(r,{value:s.value,children:s.label},s.value))]})]})]})}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(C,{children:[e.jsx(d,{children:"ID"}),e.jsx(d,{children:"Inquilino"}),e.jsx(d,{children:"Plan"}),e.jsx(d,{children:"Monto"}),e.jsx(d,{children:"Fecha de Pago"}),e.jsx(d,{children:"Período"}),e.jsx(d,{children:"Estado"}),e.jsx(d,{children:"Acciones"})]})}),e.jsx(se,{children:h.data.length===0?e.jsx(C,{children:e.jsx(l,{colSpan:8,className:"py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(le,{className:"mb-2 h-12 w-12 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No hay pagos registrados"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Registre un nuevo pago para comenzar"})]})})}):h.data.map(s=>e.jsxs(C,{children:[e.jsx(l,{children:s.id}),e.jsx(l,{children:e.jsx(q,{href:route("admin.tenants.subscription",s.tenant.id),className:"text-blue-600 hover:underline",children:s.tenant.data.company_name||s.tenant.id})}),e.jsx(l,{children:s.subscription_plan.name}),e.jsxs(l,{children:["$",parseFloat(s.amount).toFixed(2)]}),e.jsx(l,{children:new Date(s.payment_date).toLocaleDateString()}),e.jsx(l,{children:s.billing_period==="monthly"?"Mensual":"Anual"}),e.jsx(l,{children:M(s.status)}),e.jsx(l,{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(q,{href:route("admin.payments.show",s.id),children:e.jsx(v,{variant:"outline",size:"sm",children:"Ver"})})})})]},s.id))})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Mostrando ",h.from||0," - ",h.to||0," de ",h.total," pagos"]}),e.jsx("div",{className:"flex gap-2",children:h.links.map((s,i)=>e.jsx(v,{variant:s.active?"default":"outline",disabled:!s.url,onClick:()=>s.url&&g.visit(s.url),dangerouslySetInnerHTML:{__html:s.label}},i))})]})]})]})]})})})}export{es as default};
