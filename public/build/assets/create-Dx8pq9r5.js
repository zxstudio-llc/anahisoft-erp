import{r as z,u as F,j as e,H as G}from"./app-DQczwFTk.js";import{C as h,d as u,a as H}from"./card-BNPG6E-E.js";import{S as I,a as L,b as R,c as V,d as $}from"./select-D52pRjk-.js";import{B as c}from"./button-BYXnJyXv.js";import{L as m}from"./label-BchK1h47.js";import{C as f}from"./checkbox-Cvj9wDgC.js";import{I as g}from"./input-goWATpHJ.js";import{S as M}from"./switch-x9PZ-zT7.js";import{A as T}from"./app-layout-CxNCz1W0.js";import{C as q}from"./chevron-down-Bqmppv4h.js";import{C as B}from"./app-sidebar-layout-DjIGW_b8.js";import"./app-C-su-A41.js";import"./utils-CPN-yreq.js";import"./index-CTC3mW-r.js";import"./index-BBPPPnEU.js";import"./index-BfMh8EvQ.js";import"./index-KJ4lOR0W.js";import"./index-D2mu7mBH.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-CqVE9Fls.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./index-BVHM8iLO.js";import"./tenant-status-listener-Bzjk6yNz.js";import"./index-Cou6Ygo0.js";import"./toast-lvG1LsW6.js";import"./cookie-consent-DYpW6VIi.js";import"./index-DcW1-0jE.js";import"./x-CNv1352c.js";import"./dropdown-menu-DWIT9g2E.js";import"./index-CJpv9kZ5.js";import"./avatar-CLHvFKAC.js";import"./receipt-BIwab1oI.js";import"./file-text-mqHhLRuK.js";import"./folder-BRrK2jGA.js";import"./credit-card-DX0EPogz.js";import"./key-aou-cbKc.js";import"./shield-BhSokjS6.js";import"./dollar-sign-OeXEXPCy.js";import"./search-DPYN2drD.js";import"./app-logo-icon-2MFPo7KO.js";const J=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Roles",href:"/admin/roles"},{title:"Crear rol",href:"/admin/roles/create"}];function Le({permissionsByGroup:p,guards:j}){const[C,x]=z.useState({}),{data:t,setData:a,post:N,processing:b,errors:d}=F({name:"",description:"",guard_name:j[0]??"web",permissions:[],is_admin_role:!1}),v=s=>{x(i=>({...i,[s]:!i[s]}))},y=s=>{a("permissions",t.permissions.includes(s)?t.permissions.filter(i=>i!==s):[...t.permissions,s])},S=s=>{const i=s.permissions.map(r=>r.name);if(i.every(r=>t.permissions.includes(r)))a("permissions",t.permissions.filter(r=>!i.includes(r)));else{const r=[...t.permissions];i.forEach(l=>{r.includes(l)||r.push(l)}),a("permissions",r)}},_=()=>{const s=p.flatMap(i=>i.permissions.map(n=>n.name));a("permissions",s)},k=()=>{a("permissions",[])},w=()=>{const s=p.reduce((i,n)=>(i[n.group]=!0,i),{});x(s)},D=()=>{x({})},E=s=>{s.preventDefault(),N(route("admin.roles.store"))};return e.jsxs(T,{breadcrumbs:J,children:[e.jsx(G,{title:"Crear nuevo rol"}),e.jsxs("form",{onSubmit:E,className:"space-y-8 px-4 py-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Crear rol"}),e.jsx(h,{children:e.jsxs(u,{className:"flex justify-between items-center pt-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Nombre"}),e.jsx(g,{id:"name",value:t.name,onChange:s=>a("name",s.target.value),placeholder:"Nombre del rol"}),d.name&&e.jsx("p",{className:"text-sm text-red-500",children:d.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Descripción"}),e.jsx(g,{id:"description",value:t.description,onChange:s=>a("description",s.target.value),placeholder:"Descripción del rol"}),d.description&&e.jsx("p",{className:"text-sm text-red-500",children:d.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Guard"}),e.jsxs(I,{value:t.guard_name,onValueChange:s=>a("guard_name",s),children:[e.jsx(L,{children:e.jsx(R,{placeholder:"Selecciona un guard"})}),e.jsx(V,{children:j.map(s=>e.jsx($,{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(m,{htmlFor:"is_admin_role",children:"Es administrador"}),e.jsx(M,{id:"is_admin_role",checked:t.is_admin_role,onCheckedChange:s=>a("is_admin_role",!!s)})]})]})}),e.jsx(h,{children:e.jsxs(u,{className:"pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Permisos"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:w,children:"Expandir todos"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:D,children:"Contraer todos"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:_,children:"Seleccionar todos"}),e.jsx(c,{type:"button",variant:"outline",size:"sm",onClick:k,children:"Deseleccionar todos"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(s=>{const i=C[s.group],n=s.permissions.map(o=>o.name),r=n.filter(o=>t.permissions.includes(o)).length,l=n.length,A=r===l,P=r>0&&r<l;return e.jsxs(h,{className:"border",children:[e.jsx(H,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>v(s.group),className:"flex items-center gap-1 text-sm font-medium hover:text-primary transition-colors",children:[i?e.jsx(q,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"}),e.jsx("span",{className:"capitalize",children:s.group.replace("_"," ")})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",r,"/",l,")"]})]}),e.jsx(f,{checked:A,onCheckedChange:()=>S(s),className:P?"data-[state=checked]:bg-primary/50":""})]})}),i&&e.jsx(u,{className:"pt-0",children:e.jsx("div",{className:"space-y-2",children:s.permissions.map(o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{id:`perm-${o.id}`,checked:t.permissions.includes(o.name),onCheckedChange:()=>y(o.name)}),e.jsx(m,{htmlFor:`perm-${o.id}`,className:"text-sm cursor-pointer flex-1",children:o.description})]},o.id))})})]},s.group)})})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(c,{type:"submit",disabled:b,children:"Crear rol"})})]})]})}export{Le as default};
