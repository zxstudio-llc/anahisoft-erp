import{r as m,j as e}from"./app-DQczwFTk.js";import{C as l,a as c,b as n,d,c as R}from"./card-BNPG6E-E.js";import{B}from"./button-BYXnJyXv.js";import{I as U}from"./input-goWATpHJ.js";import{B as j}from"./badge-CIPxAGrn.js";import{T as _,a as O,b as g,c as a,d as V,e as r}from"./table-J6M9UKS6.js";import{S as p,a as f,b as v,c as w,d as t}from"./select-D52pRjk-.js";import{S as H}from"./shield-BhSokjS6.js";import{U as K}from"./user-Sh9zbuY1.js";import{C as Z}from"./calendar-RZLbZmV6.js";import{C as k}from"./clock-BUIFzQLb.js";import{D as q}from"./download-DcYaHDKt.js";import{S as G}from"./search-DPYN2drD.js";import"./app-C-su-A41.js";import"./utils-CPN-yreq.js";import"./index-D2mu7mBH.js";import"./index-CTC3mW-r.js";import"./index-BBPPPnEU.js";import"./index-BfMh8EvQ.js";import"./index-KJ4lOR0W.js";import"./index-DSuT5VJt.js";import"./index-CnB8Y-kE.js";import"./index-CqVE9Fls.js";import"./index-BOxxC3ps.js";import"./index-ClSqUjUN.js";import"./createLucideIcon-D40S4Mwt.js";import"./index-7Ou4doz_.js";import"./index-CX1ZUDb2.js";import"./chevron-down-Bqmppv4h.js";function be({auditLogs:i=[{id:"1",timestamp:"2024-01-15T10:30:00Z",user:"admin@company.com",action:"LOGIN",module:"Authentication",details:"Usuario administrador inició sesión exitosamente",ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",status:"success",severity:"low"},{id:"2",timestamp:"2024-01-15T10:25:00Z",user:"juan.perez@company.com",action:"CREATE_INVOICE",module:"Invoicing",details:"Creó nueva factura INV-001 por $2,500.00",ipAddress:"192.168.1.101",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",status:"success",severity:"medium"},{id:"3",timestamp:"2024-01-15T10:20:00Z",user:"maria.gonzalez@company.com",action:"UPDATE_CUSTOMER",module:"CRM",details:"Actualizó información del cliente Acme Corp",ipAddress:"192.168.1.102",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",status:"success",severity:"low"},{id:"4",timestamp:"2024-01-15T10:15:00Z",user:"carlos.ruiz@company.com",action:"DELETE_DOCUMENT",module:"Documents",details:"Eliminó documento: Contrato temporal v1.0",ipAddress:"192.168.1.103",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",status:"success",severity:"high"},{id:"5",timestamp:"2024-01-15T10:10:00Z",user:"unknown@external.com",action:"FAILED_LOGIN",module:"Authentication",details:"Intento de inicio de sesión fallido - credenciales incorrectas",ipAddress:"203.0.113.45",userAgent:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36",status:"failed",severity:"critical"}]}){const[o,y]=m.useState(""),[x,b]=m.useState("all"),[u,A]=m.useState("all"),[h,C]=m.useState("all"),S=s=>{switch(s){case"success":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},T=s=>{switch(s){case"low":return"bg-blue-100 text-blue-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=i.filter(s=>{const F=s.user.toLowerCase().includes(o.toLowerCase())||s.action.toLowerCase().includes(o.toLowerCase())||s.details.toLowerCase().includes(o.toLowerCase()),W=x==="all"||s.module===x,D=u==="all"||s.status===u,L=h==="all"||s.severity===h;return F&&W&&D&&L}),E=Array.from(new Set(i.map(s=>s.module))),M=i.length,I=i.filter(s=>s.status==="failed").length,z=i.filter(s=>s.severity==="critical").length;return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Registro de Auditoría"}),e.jsx("p",{className:"text-gray-600",children:"Monitorea todas las actividades y cambios en el sistema"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Total Eventos"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:M}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Eventos registrados hoy"})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Acciones Fallidas"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:I}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requieren atención"})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Eventos Críticos"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:z}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Alta prioridad"})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Usuarios Activos"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(d,{children:[e.jsx("div",{className:"text-2xl font-bold",children:new Set(i.map(s=>s.user)).size}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"En las últimas 24h"})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Registro de Actividades"}),e.jsx(R,{children:"Historial completo de acciones del sistema"})]}),e.jsxs(B,{variant:"outline",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Exportar Registro"]})]})}),e.jsxs(d,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(U,{placeholder:"Buscar en registros...",value:o,onChange:s=>y(s.target.value),className:"pl-10"})]}),e.jsxs(p,{value:x,onValueChange:b,children:[e.jsx(f,{className:"w-full sm:w-48",children:e.jsx(v,{placeholder:"Módulo"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todos los módulos"}),E.map(s=>e.jsx(t,{value:s,children:s},s))]})]}),e.jsxs(p,{value:u,onValueChange:A,children:[e.jsx(f,{className:"w-full sm:w-48",children:e.jsx(v,{placeholder:"Estado"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todos los estados"}),e.jsx(t,{value:"success",children:"Exitoso"}),e.jsx(t,{value:"failed",children:"Fallido"}),e.jsx(t,{value:"warning",children:"Advertencia"})]})]}),e.jsxs(p,{value:h,onValueChange:C,children:[e.jsx(f,{className:"w-full sm:w-48",children:e.jsx(v,{placeholder:"Severidad"})}),e.jsxs(w,{children:[e.jsx(t,{value:"all",children:"Todas las severidades"}),e.jsx(t,{value:"low",children:"Baja"}),e.jsx(t,{value:"medium",children:"Media"}),e.jsx(t,{value:"high",children:"Alta"}),e.jsx(t,{value:"critical",children:"Crítica"})]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(_,{children:[e.jsx(O,{children:e.jsxs(g,{children:[e.jsx(a,{children:"Fecha/Hora"}),e.jsx(a,{children:"Usuario"}),e.jsx(a,{children:"Acción"}),e.jsx(a,{children:"Módulo"}),e.jsx(a,{children:"Detalles"}),e.jsx(a,{children:"Estado"}),e.jsx(a,{children:"Severidad"}),e.jsx(a,{children:"IP"})]})}),e.jsx(V,{children:N.map(s=>e.jsxs(g,{children:[e.jsx(r,{className:"font-mono text-sm",children:new Date(s.timestamp).toLocaleString()}),e.jsx(r,{children:s.user}),e.jsx(r,{className:"font-medium",children:s.action}),e.jsx(r,{children:e.jsx(j,{variant:"outline",children:s.module})}),e.jsx(r,{className:"max-w-xs truncate",children:s.details}),e.jsx(r,{children:e.jsx(j,{className:S(s.status),children:s.status==="success"?"Exitoso":s.status==="failed"?"Fallido":"Advertencia"})}),e.jsx(r,{children:e.jsx(j,{className:T(s.severity),children:s.severity==="low"?"Baja":s.severity==="medium"?"Media":s.severity==="high"?"Alta":"Crítica"})}),e.jsx(r,{className:"font-mono text-sm",children:s.ipAddress})]},s.id))})]})}),N.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No se encontraron registros que coincidan con los criterios."})})]})]})]})})}export{be as default};
